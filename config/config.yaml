# Sirius - AI DevOps Agent Configuration
# Environment variables can override any setting using SIRIUS_ prefix

server:
  host: 0.0.0.0
  port: 8080
  workers: 1  # Single worker to prevent duplicate event processing

# NVIDIA NIM Configuration
nvidia:
  environment: development  # development | production

  development:
    base_url: https://integrate.api.nvidia.com/v1
    model: deepseek-ai/deepseek-r1-distill-qwen-32b
    api_key: ${NVIDIA_API_KEY}  # Set via environment variable
    timeout: 60
    max_tokens: 4096
    temperature: 0.5

  production:
    base_url: http://localhost:8000/v1  # Self-hosted NIM
    model: meta/llama-3.1-70b-instruct
    timeout: 60
    max_tokens: 4096
    temperature: 0.3

# Alert Processing
processing:
  dedup_window_seconds: 3600     # 1 hour - alerts won't be reprocessed within this window
  correlation_window_seconds: 3600  # 1 hour - correlate alerts to same incident
  max_queue_size: 1000

# SSH Configuration
ssh:
  private_key_path: ${SSH_KEY_PATH:-/home/agent/.ssh/id_rsa}
  username: ${SSH_USERNAME:-ec2-user}
  timeout_seconds: 30
  known_hosts_path: ${SSH_KNOWN_HOSTS:-/home/agent/.ssh/known_hosts}
  port: 22

# Approval Settings
approval:
  auto_approve_risk_levels:
    - low  # Auto-approve investigation/diagnostic tools (read-only, safe)
  require_approval_risk_levels:
    - medium
    - high
    - critical
  slack_webhook_url: ${SLACK_WEBHOOK_URL}
  slack_bot_token: ${SLACK_BOT_TOKEN}
  slack_channel: "#oncall-approvals"
  approval_timeout_minutes: 5
  escalation_timeout_minutes: 10

# Server Inventory
inventory:
  type: file
  path: config/servers.yaml

# Redis (optional - for state persistence)
redis:
  url: redis://localhost:6379/0

# Logging
logging:
  level: INFO
  format: json
  audit_log_path: /var/log/sirius/audit.log

# v2.0: Memory and Pattern Recognition
memory:
  enabled: true
  storage_path: /var/lib/sirius/memory
  similarity_threshold: 0.75
  max_similar_incidents: 5
  use_vector_db: false  # Set true if ChromaDB is installed

# v2.0: Training Data Collection
training_data:
  enabled: true
  storage_path: /var/lib/sirius/training_data
  export_format: jsonl
  min_quality_score: 0.6
  retention_days: 365

# v2.0: Agent Orchestration
orchestration:
  max_iterations: 5
  min_confidence_threshold: 0.7
  fast_path_confidence: 0.85
  iteration_timeout_seconds: 300

# v2.0: Runbook Automation
runbooks:
  enabled: true
  template_path: config/runbooks/
  auto_generate: true
  require_verification: true
